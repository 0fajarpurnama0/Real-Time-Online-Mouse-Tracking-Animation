/*! mcmmmska 2019-06-28 */

define(["jquery","jqueryui"],function(k,e){return{init:function(){k(document).ready(function(){$i=0,$name=[],$email=[],$date=[new Date],$now=[new Date],$duration=[0],$active=[],$x=[0],$y=[0],$ip_address=[],$current_url=[];var i=!($samplingmode=[]);$leftclick=[!1],$rightclick=[!1],$middleclick=[!1],$keyboardtype=[];var a,o,t=0,c=0;$scrollleft=[0],$scrolltop=[0],$windowwidth=[window.innerWidth],$windowheight=[window.innerHeight],$screenwidth=[screen.width],$screenheight=[screen.height],$zoom=[100*screen.width/window.innerWidth],$mTouch=[];var d,e,n=0,$=0;function s(){k(window).off(),k("#logging").is(":checked")?k("#sampling-rate-mode-checkbox").is(":checked")?e=setInterval(function(){i&&(r(),$i+=1,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),i=!1),k("#mouseclick").is(":checked")&&k(window).mousedown(function(e){switch(i=!0,l(),$x[$i]=e.pageX,$y[$i]=e.pageY,e.which){case 1:$leftclick[$i]=!0,a="left";break;case 2:$middleclick[$i]=!0,a="middle";break;case 3:$rightclick[$i]=!0,a="right";break;default:console.log("You have a strange Mouse!")}}).mouseup(function(e){$i+=1,l(),a="no click",$leftclick[$i]=!1,$middleclick[$i]=!1,$rightclick[$i]=!1,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#mousemove").is(":checked")&&k(window).mousemove(function(e){i=!0,l(),$x[$i]=e.pageX,$y[$i]=e.pageY}),k("#mousescroll").is(":checked")&&k(window).scroll(function(e){i=!0,l(),Number.isInteger($x[$i])&&Number.isInteger($y[$i])&&(t!=k(document).scrollLeft()&&($x[$i]-=t,t=k(document).scrollLeft(),$x[$i]+=t),c!=k(document).scrollTop()&&($y[$i]-=c,c=k(document).scrollTop(),$y[$i]+=c)),$scrollleft[$i]=k(document).scrollLeft(),$scrolltop[$i]=k(document).scrollTop()}),k("#keyboardpress").is(":checked")&&k(window).keypress(function(e){i=!0,l(),$keyboardtype[$i]+=e.key,o=e.key}),k("#tabstatus-checkbox").is(":checked")&&k(window).mouseenter(function(){$i+=1,k("#active").text("active"),l(),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).mouseover(function(){$i+=1,k("#active").text("active"),l(),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("pageshow",function(){$i+=1,k("#active").text("active"),l(),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).mouseleave(function(){$i+=1,l(),k("#active").text("inactive"),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).mouseout(function(){$i+=1,l(),k("#active").text("inactive"),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("pagehide",function(){$i+=1,l(),k("#active").text("inactive"),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#zoom").is(":checked")&&k(window).resize(function(){$i+=1,l(),$zoom[$i]=100*screen.width/window.innerWidth,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#touch").is(":checked")&&k(window).on("touchstart",function(e){$i+=1,l(),$mTouch[$i]="touched",$x[$i]=e.touches[0].pageX,$y[$i]=e.touches[0].pageY,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("touchend",function(e){$i+=1,l(),$mTouch[$i]="untouched",k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("touchcancel",function(e){$i+=1,l(),$mTouch[$i]="interrupted",$x[$i]=e.touches[0].pageX,$y[$i]=e.touches[0].pageY,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#touchmove").is(":checked")&&k(window).on("touchmove",function(e){$i+=1,l(),$mTouch[$i]="moving",$x[$i]=e.touches[0].pageX,$y[$i]=e.touches[0].pageY,zoom=100*screen.width/window.visualViewport.width,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()})},1e3/k("#sampling-rate").val()):(clearTimeout(e),k("#mouseclick").is(":checked")&&k(window).mousedown(function(e){switch($i+=1,l(),$x[$i]=e.pageX,$y[$i]=e.pageY,e.which){case 1:$leftclick[$i]=!0,a="left click";break;case 2:$middleclick[$i]=!0,a="middle click";break;case 3:$rightclick[$i]=!0,a="right click";break;default:console.log("You have a strange Mouse!")}k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).mouseup(function(e){$i+=1,l(),a="no click",$leftclick[$i]=!1,$middleclick[$i]=!1,$rightclick[$i]=!1,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#mousemove").is(":checked")&&k(window).mousemove(function(e){$i+=1,l(),$x[$i]=e.pageX,$y[$i]=e.pageY,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#mousescroll").is(":checked")&&k(window).scroll(function(e){$i+=1,l(),Number.isInteger($x[$i])&&Number.isInteger($y[$i])&&(t!=k(document).scrollLeft()&&($x[$i]-=t,t=k(document).scrollLeft(),$x[$i]+=t),c!=k(document).scrollTop()&&($y[$i]-=c,c=k(document).scrollTop(),$y[$i]+=c)),$scrollleft[$i]=k(document).scrollLeft(),$scrolltop[$i]=k(document).scrollTop(),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#keyboardpress").is(":checked")&&k(window).keypress(function(e){$i+=1,l(),$keyboardtype[$i]+=e.key,o=e.key,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#tabstatus-checkbox").is(":checked")&&k(window).mouseenter(function(){$i+=1,k("#active").text("active"),l(),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).mouseover(function(){$i+=1,k("#active").text("active"),l(),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("pageshow",function(){$i+=1,k("#active").text("active"),l(),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).mouseleave(function(){$i+=1,l(),k("#active").text("inactive"),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).mouseout(function(){$i+=1,l(),k("#active").text("inactive"),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("pagehide",function(){$i+=1,l(),k("#active").text("inactive"),k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#zoom").is(":checked")&&k(window).resize(function(){$i+=1,l(),$zoom[$i]=100*screen.width/window.innerWidth,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#touch").is(":checked")&&k(window).on("touchstart",function(e){$i+=1,l(),$mTouch[$i]="touched",$x[$i]=e.touches[0].pageX,$y[$i]=e.touches[0].pageY,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("touchend",function(e){$i+=1,l(),$mTouch[$i]="untouched",k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("touchcancel",function(e){$i+=1,l(),$mTouch[$i]="interrupted",$x[$i]=e.touches[0].pageX,$y[$i]=e.touches[0].pageY,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#touchmove").is(":checked")&&k(window).on("touchmove",function(e){$i+=1,l(),$mTouch[$i]="moving",$x[$i]=e.touches[0].pageX,$y[$i]=e.touches[0].pageY,zoom=100*screen.width/window.visualViewport.width,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}),k("#event-type").is(":checked")&&k(window).on("auxclick",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("contextmenu",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("dblclick",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("select",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("wheel",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("copy",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("cut",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()}).on("paste",function(e){$i+=1,l(),d=e.type,k("#data-to-database-on-fly-checkbox").is(":checked")&&h(k("#data-to-database-on-fly").val()),r()})):k(window).off()}function l(){n+=1,$+=1,k("#event-type").is(":checked")?$event_type[$i]=event.type:$event_type[$i]="disabled",k("#mouseclick").is(":checked")?($leftclick[$i]=$leftclick[$i-1],$rightclick[$i]=$rightclick[$i-1],$middleclick[$i]=$middleclick[$i-1]):($leftclick[$i]="disabled",$rightclick[$i]="disabled",$middleclick[$i]="disabled"),k("#touch").is(":checked")?$mTouch[$i]=$mTouch[$i-1]:$mTouch[$i]="disabled",k("#mousemove").is(":checked")||k("#touchmove").is(":checked")?($x[$i]=$x[$i-1],$y[$i]=$y[$i-1]):($x[$i]="disabled",$y[$i]="disabled"),k("#mousescroll").is(":checked")?($scrollleft[$i]=$scrollleft[$i-1],$scrolltop[$i]=$scrolltop[$i-1]):($scrollleft[$i]="disabled",$scrolltop[$i]="disabled"),k("#keyboardpress").is(":checked")?$keyboardtype[$i]="":$keyboardtype[$i]="disabled",k("#tabstatus-checkbox").is(":checked")?$active[$i]=k("#active").text():$active[$i]="disabled",k("#name-checkbox").is(":checked")?$name[$i]=k("#name").val():$name[$i]="anonymous",k("#email-checkbox").is(":checked")?$email[$i]=k("#email").val():$email[$i]="anonymous",k("#windowsize-checkbox").is(":checked")?($windowwidth[$i]=window.innerWidth,$windowheight[$i]=window.innerHeight):($windowwidth[$i]="disabled",$windowheight[$i]="disabled"),k("#screensize-checkbox").is(":checked")?($screenwidth[$i]=screen.width,$screenheight[$i]=screen.height):($screenwidth[$i]="disabled",$screenheight[$i]="disabled"),k("#zoom").is(":checked")?$zoom[$i]=100*screen.width/window.innerWidth:$zoom[$i]="disabled",k("#currenturl-checkbox").is(":checked")?$current_url[$i]=window.location.href:$current_url[$i]="disabled",$samplingmode[$i]=k("#sampling-rate-mode-checkbox").prop("checked"),k("#ipaddress-checkbox").is(":checked")?(k.getJSON("https://api.ipify.org?format=jsonp&callback=?",function(e){$ip_address[$i]=e.ip}),null==$ip_address[$i]&&($ip_address[$i]=$ip_address[$i-1])):$ip_address[$i]="disabled",k("#date-checkbox").is(":checked")?$date[$i]=new Date:$date[$i]="disabled",$now[$i]=new Date,k("#duration-checkbox").is(":checked")?$duration[$i]=($now[$i]-$now[$i-1])/1e3:$duration[$i]="disabled"}function h(e){var i={};i.$file=String($name[1]).replace(" ","")+String($now[1]).replace(":",".").replace(" ","")+".json","anonymous"!=$name[$i]&&(i.$name=$name[$i]),"anonymous"!=$email[$i]&&(i.$email=$email[$i]),"disabled"!=$date[$i]&&(i.$date=$date[$i]),"disabled"!=$x[$i]&&(i.$x=$x[$i]),"disabled"!=$y[$i]&&(i.$y=$y[$i]),"disabled"!=$active[$i]&&(i.$active=$active[$i]),"disabled"!=$duration[$i]&&(i.$duration=$duration[$i]),"disabled"!=$current_url[$i]&&(i.$current_url=$current_url[$i]),"disabled"!=$ip_address[$i]&&(i.$ip_address=$ip_address[$i]),"disabled"!=$samplingmode[$i]&&(i.$samplingmode=$samplingmode[$i]),"disabled"!=$leftclick[$i]&&(i.$leftclick=$leftclick[$i]),"disabled"!=$rightclick[$i]&&(i.$rightclick=$rightclick[$i]),"disabled"!=$middleclick[$i]&&(i.$middleclick=$middleclick[$i]),"disabled"!=$mTouch[$i]&&(i.$mTouch=$mTouch[$i]),"disabled"!=$keyboardtype[$i]&&(i.$keyboardtype=$keyboardtype[$i]),"disabled"!=$scrollleft[$i]&&(i.$scrollleft=$scrollleft[$i]),"disabled"!=$scrolltop[$i]&&(i.$scrolltop=$scrolltop[$i]),"disabled"!=$windowwidth[$i]&&(i.$windowwidth=$windowwidth[$i]),"disabled"!=$windowheight[$i]&&(i.$windowheight=$windowheight[$i]),"disabled"!=$screenwidth[$i]&&(i.$screenwidth=$screenwidth[$i]),"disabled"!=$screenheight[$i]&&(i.$screenheight=$screenheight[$i]),"disabled"!=$zoom[$i]&&(i.$zoom=$zoom[$i]),"disabled"!=$event_type[$i]&&(i.$event_type=$event_type[$i]),k.post(e,i,function(e,i){console.log(e),console.log(i)})}function r(){k("#demo-checkbox").is(":checked")&&k("#demo").html("<strong>MouseX</strong>: "+$x[$i]+" ,<strong>MouseY</strong>: "+$y[$i]+" ,<strong>ScrollLeft</strong>: "+$scrollleft[$i]+" ,<strong>ScrollTop</strong>: "+$scrolltop[$i]+" ,<strong>KeyboardPress</strong>: "+o+" ,<strong>MouseClick</strong>: "+a+"<strong>Touch</strong>: "+$mTouch[$i]+" ,<strong>Zoom</strong>: "+$zoom[$i]+"% , <strong>events</strong>: "+n+" , <strong>eps</strong>: "+$+" , <strong>event type</strong>: "+$event_type[$i]+" , <strong>special event type</strong>: "+d).css("display","block")}$event_type=[],k("#demo-checkbox").is(":checked")&&k("body").prepend('<span class="sticky" id="demo"></span>'),k("#logging, #mouseclick, #mousemove, #mousescroll, #keyboardpress, #sampling-rate-mode-checkbox, #data-to-file-on-fly-checkbox, #data-to-database-on-fly-checkbox").click(function(){s()}).ready(function(){s()}),k("#demo-checkbox").click(function(){r()}).ready(function(){r()}),setInterval(function(){$=0},1e3)}).on("beforeunload",function(){k("#data-to-file-on-fly-checkbox").is(":checked")&&post_data_fly(k("#file-server-scrip").val())})}}});